---
title: "IDS investigation worksheet"
author: "by Team-Name: User1, User2, User3, User4 & User5"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(cherryblossom)  
library(ggplot2)
library(caTools)
```


```{r load-data}
# load your data 
data <- read.csv("~/final project/data/laptop_data_cleaned.csv")

# Data cleaning
data <- data %>%
  filter(!is.na(Price)) %>%  # Remove rows with missing Price
  mutate(TypeName = as.factor(TypeName), 
         Cpu_brand = as.factor(Cpu_brand))

# Data exploration
summary(data)

# Visualize the distribution of the Price variable
ggplot(data, aes(x = Price)) + 
  geom_histogram(binwidth = 100, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Price Distribution", x = "Price", y = "Frequency")

# Visualize the relationship between RAM and Price
ggplot(data, aes(x = Ram, y = Price)) + 
  geom_point(aes(color = Cpu_brand), alpha = 0.7) +
  geom_smooth(method = 'lm', se = FALSE, color = "red") + 
  labs(title = "RAM vs. Price", x = "RAM (GB)", y = "Price")

# Visualize the relationship between Weight and Price
ggplot(data, aes(x = Weight, y = Price)) + 
  geom_point(aes(color = Cpu_brand), alpha = 0.7) +
  geom_smooth(method = 'lm', se = FALSE, color = "green") + 
  labs(title = "Weight vs. Price", x = "Weight (kg)", y = "Price")

# Visualize the distribution of the Weight variable
ggplot(data, aes(x = Weight)) + 
  geom_histogram(binwidth = 0.5, fill = "lightgreen", color = "black", alpha = 0.7) +
  labs(title = "Weight Distribution", x = "Weight (kg)", y = "Frequency")

# Split the dataset into training and testing sets
set.seed(123)
split <- sample.split(data$Price, SplitRatio = 0.8)  # 80% training, 20% testing
train <- subset(data, split == TRUE)
test <- subset(data, split == FALSE)

# Train the linear regression model
model <- lm(Price ~ Ram + Weight + Ppi, data = train)
summary(model)

# Comment on suitability model
plot(model, which = 1)
plot(model, which = 2)
plot(model, which = 3)
plot(model, which = 4)
plot(model, which = 5)

# Prediction and evaluation
pred <- predict(model, test)  # Predict on the test set
rmse <- sqrt(mean((test$Price - pred)^2))  # Calculate Root Mean Square Error (RMSE)
r2 <- 1 - sum((test$Price - pred)^2) / sum((test$Price - mean(test$Price))^2)  # Calculate R-squared

# Output RMSE and R-squared
print(paste("RMSE: ", rmse))
print(paste("R-squared: ", r2))

# Residual analysis
residuals <- test$Price - pred
ggplot(data.frame(residuals), aes(x = residuals)) +
  geom_histogram(binwidth = 100, fill = "lightblue", color = "black", alpha = 0.7) +
  labs(title = "Residuals Distribution", x = "Residuals", y = "Frequency")

```


