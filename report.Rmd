---
title: "Predictive Analytics for Laptop Prices"
author: "by Team-Name: Zhenye Cao, Siran Luo, Yunxi Guan,Zongyang Jin, Tianmu Xu , Qinhao Feng"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, include = FALSE}
library(tidyverse)
library(Metrics)
library(ggplot2)



```


```{r load-data, include=FALSE}
# Load your data
laptop_data <- read.csv("~/final-project/data/laptop_data_cleaned.csv")

# Preview the data
head(laptop_data)

# Check for missing values
colSums(is.na(laptop_data))

# Remove missing values
laptop_data <- laptop_data %>% drop_na()

# Descriptive statistics
summary(laptop_data)

# Correlation matrix for numeric variables
cor_matrix <- laptop_data %>%
  select(Price, SSD, Weight, Ppi, Ram) %>%
  cor()
print(cor_matrix)

# Split into training and testing datasets
set.seed(123)
train_index <- sample(1:nrow(laptop_data), 0.8 * nrow(laptop_data))
train_data <- laptop_data[train_index, ]
test_data <- laptop_data[-train_index, ]

# Train improved linear regression model
linear_model <- lm(
  Price ~ Weight + Ppi + SSD + Cpu_brand + TypeName + Ram,
  data = train_data
)
linear_model_2 <- lm(Price ~ ., data = train_data)

# Model evaluation
summary(linear_model)
summary(linear_model_2)

# Predict on test data
y_pred <- predict(linear_model, newdata = test_data)

# Calculate RMSE
rmse_value <- rmse(test_data$Price, y_pred)
cat("Linear Model RMSE:", rmse_value, "\n")

# Actual vs Predicted Plot
ggplot(data.frame(Actual = test_data$Price, Predicted = y_pred), aes(x = Actual, y = Predicted)) +
  geom_point(color = "blue", alpha = 0.6) +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(title = "Actual vs Predicted (Linear Model)", x = "Actual Price", y = "Predicted Price")

# Residual diagnostics
par(mfrow = c(2, 2))  
plot(linear_model)



```


## Research Question

Describe your research question here. Include why this question might be of interest. 





## Data

Briefly describe your dataset here - include a description of the key variables you will be investigating. 
Include a citation for your data. 
See http://libraryguides.vu.edu.au/c.php?g=386501&p=4347840 for guidance on proper citation for datasets. 
If you got your data off the web, make sure to state the retrieval date.






## Findings

The write-up of your project and findings go here. 

Think of this as the text of your presentation with some extra detail to cover what there was not time to discuss in the presentation. This might include any assumptions you made when doing your analysis, any limitations of the work you have done or any ideas you have for future work. Feel free to split this section into subsections to make it easier to read. 

The length should be roughly 1,500 words. 
If you want to use a word count addin, you can install this by copying and pasting the following into RStudio:

`devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)`

You will then need to restart RStudio. Once you have done that, select the text you want to count the words of, go to Addins, and select the `Word count` addin.
This addin counts words using two different algorithms, but the results should be similar and as long as you're in the ballpark of 1,500 words, you're good! 
The addin will ignore code chunks and only count the words in prose. If you don't want to use the addin you can always copy and paste the text into Microsoft Word to do a Word Count!

You can also load your data here and present any analysis results / plots.
Make sure to hide your code with  `echo = FALSE` unless the point you are trying to make is about the code itself, in which case you should show your code.





## References

List any references here. You should, at a minimum, list your data source.


